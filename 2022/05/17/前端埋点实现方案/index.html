<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="dark"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png"><link rel="icon" href="/img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="drinkwd"><meta name="keywords" content="drinkwd"><meta name="description" content="前言领导今天又来活了😣，要记录每个页面的停留时间，以及页面的操作，是由哪个页面跳转过来的，给每个页面生成GUID上报给服务端，并且需要携带设备型号和设备唯一标识🙄 名称解释UV（Unique visitor）是指通过互联网访问、浏览这个网页的自然人。访问您网站的一台电脑客户端为一个访客。00:00-24:00内相同的客户端只被计算一次。一天内同个访客多次访问仅计算一个UV。 IP（Intern"><meta property="og:type" content="article"><meta property="og:title" content="前端埋点实现方案"><meta property="og:url" content="https://drinkwd.github.io/2022/05/17/%E5%89%8D%E7%AB%AF%E5%9F%8B%E7%82%B9%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%A1%88/index.html"><meta property="og:site_name" content="drinkwd的个人博客"><meta property="og:description" content="前言领导今天又来活了😣，要记录每个页面的停留时间，以及页面的操作，是由哪个页面跳转过来的，给每个页面生成GUID上报给服务端，并且需要携带设备型号和设备唯一标识🙄 名称解释UV（Unique visitor）是指通过互联网访问、浏览这个网页的自然人。访问您网站的一台电脑客户端为一个访客。00:00-24:00内相同的客户端只被计算一次。一天内同个访客多次访问仅计算一个UV。 IP（Intern"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://drinkwd.github.io/img/blog_img/index13.png"><meta property="article:published_time" content="2022-05-17T00:47:32.336Z"><meta property="article:modified_time" content="2022-05-17T00:47:32.336Z"><meta property="article:author" content="drinkwd"><meta property="article:tag" content="Vue"><meta property="article:tag" content="uni-app"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://drinkwd.github.io/img/blog_img/index13.png"><title>前端埋点实现方案 - drinkwd的个人博客</title><link rel="stylesheet" href="https://cdn.staticfile.org/bootstrap/4.5.3/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/highlight.js/10.4.0/styles/vs2015.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.0.0/css/all.min.css"><script id="fluid-configs">var Fluid=window.Fluid||{},CONFIG={hostname:"drinkwd.github.io",root:"/",version:"1.8.14",typing:{enable:!0,typeSpeed:70,cursorChar:"",loop:!1},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},copy_btn:!0,image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!1,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1}},search_path:"/local-search.xml"}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><meta name="generator" content="Hexo 5.4.2"></head><body><header style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>drinkwd的博客</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> 友链</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner" id="banner" parallax="true" style="background:url(/img/blog_img/banner13.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="page-header text-center fade-in-up"><span class="h2" id="subtitle" title="前端埋点实现方案"></span><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> drinkwd </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2022-05-17 08:47" pubdate>2022年5月17日 早上</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 7.6k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 64 分钟 </span><span id="busuanzi_container_page_pv" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="busuanzi_value_page_pv"></span> 次</span></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto"><h1 style="display:none">前端埋点实现方案</h1><div class="markdown-body"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>领导今天又来活了😣，要记录每个页面的停留时间，以及页面的操作，是由哪个页面跳转过来的，给每个页面生成<code>GUID</code>上报给服务端，并且需要携带设备型号和设备唯一标识🙄</p><h2 id="名称解释"><a href="#名称解释" class="headerlink" title="名称解释"></a>名称解释</h2><h4 id="UV（Unique-visitor）"><a href="#UV（Unique-visitor）" class="headerlink" title="UV（Unique visitor）"></a>UV（Unique visitor）</h4><p>是指通过互联网访问、浏览这个网页的自然人。访问您网站的一台电脑客户端为一个访客。<code>00:00-24:00</code>内相同的客户端只被计算一次。一天内同个访客多次访问仅计算一个<code>UV</code>。</p><h4 id="IP（Internet-Protocol）"><a href="#IP（Internet-Protocol）" class="headerlink" title="IP（Internet Protocol）"></a>IP（Internet Protocol）</h4><p>独立<code>IP</code>是指访问过某站点的<code>IP</code>总数，以用户的IP地址作为统计依据。<code>00:00-24:00</code>内相同<code>IP</code>地址之被计算一次。</p><p>UV与IP区别</p><blockquote><p>如：你和你的家人用各自的账号在同一台电脑上登录新浪微博，则<code>IP</code>数+1，<code>UV</code>数+2。由于使用的是同一台电脑，所以<code>IP</code>不变，但使用的不同账号，所以<code>UV</code>+2</p></blockquote><h4 id="PV（Page-View）"><a href="#PV（Page-View）" class="headerlink" title="PV（Page View）"></a>PV（Page View）</h4><p>即页面浏览量或点击量，用户每1次对网站中的每个网页访问均被记录1个<code>PV</code>。用户对同一页面的多次访问，访问量累计，用以衡量网站用户访问的网页数量。</p><h4 id="VV（Visit-View）"><a href="#VV（Visit-View）" class="headerlink" title="VV（Visit View）"></a>VV（Visit View）</h4><p>用以统计所有访客1天内访问网站的次数。当访客完成所有浏览并最终关掉该网站的所有页面时便完成了一次访问，同一访客1天内可能有多次访问行为，访问次数累计。</p><p>PV与VV区别</p><blockquote><p>如：你今天10点钟打开了百度，访问了它的三个页面；11点钟又打开了百度，访问了它的两个页面，则PV数+5，VV数+2.PV是指页面的浏览次数，VV是指你访问网站的次数。</p></blockquote><h2 id="埋点分类"><a href="#埋点分类" class="headerlink" title="埋点分类"></a>埋点分类</h2><h3 id="代码埋点"><a href="#代码埋点" class="headerlink" title="代码埋点"></a>代码埋点</h3><p>通过代码的方式在页面中嵌入逻辑🎨，比如捕获一个点击事件，在这个点击事件之前加入代码埋点⛑,上报给后台🥐。国内已经有很多成型的服务商了如友盟，百度统计等🌯，都提供了比较成型的方案🎨，并可以在后台管理系统中查看比较详细的数据分析🧵，但是肯定会有领导想要把这些事情掌握在自己的手中，我们就只能通过自身开发来实现代码埋点🍞。</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/071c7d15aebe422aa02bbbab3d62c0f1~tplv-k3u1fbpfcp-zoom-1.image" srcset="/img/loading.gif" lazyload></p><ul><li><p>优点：</p><blockquote><ul><li>控制精准，可以非常精确地选择什么时候发送数据。</li><li>传递多样化自定义属性、自定义事件，传递比较丰富的数据到服务端。</li></ul></blockquote></li><li><p>缺点：</p><blockquote><ul><li>埋点代价比较大，每一个控件的埋点都需要添加相应的代码，不仅工作量大，必须是技术人员才能完成。</li><li>更新的代价比较大，每一次更新埋点方案，都必须改代码。</li></ul></blockquote></li></ul><h3 id="可视化埋点"><a href="#可视化埋点" class="headerlink" title="可视化埋点"></a>可视化埋点</h3><p>个人理解的可视化埋点应该是肯定需要第三方的服务商支持🍜，不会有做专门业务的公司去做可视化埋点的解决方案。可视化埋点开发人员除集成采集可视化<code>SDK</code>外👜，不需要额外去写埋点代码🍠，而是由业务人员或运营人员通过访问分析平台的圈选功能🤔，来“圈”出需要对用户行为进行捕捉的控件🎪，并给出事件命名🚘。圈选完毕后，这些配置会同步到各个用户的终端上😮，由采集<code>SDK</code>按照圈选的配置自动进行用户行为数据的采集和发送🚇。</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/556f975e2f224dad9e8012c70801a1a5~tplv-k3u1fbpfcp-zoom-1.image" srcset="/img/loading.gif" lazyload><br>优点：</p><blockquote><ul><li>埋点代价小，更新代价小</li><li>埋点只需业务同学接入，开发只需对接可视化<code>SDK</code></li></ul></blockquote><p>缺点：</p><blockquote><ul><li>无法做到自定义获取数据</li><li>可视化埋点覆盖的功能有限</li><li>仅支持客户端行为</li></ul></blockquote><h3 id="无痕埋点"><a href="#无痕埋点" class="headerlink" title="无痕埋点"></a>无痕埋点</h3><p>无痕埋点又叫全埋点🥪，网上又很多文章写的都是无痕埋点是将所有事件的操作全部上报😀，但是我们在实现的过程中肯定是不会监听那么多的事件吧😋，但是好像也有第三方服务商sdk集成了所有事件😏。</p><blockquote><p><strong>我的个人理解</strong>无痕埋点是针对某一个单一事件，在全局实现监听达到上报，而不是全部事件上报才叫无痕埋点🥙。只要有某个事件在全局实现监听，针对这个事件的埋点方式就称为无痕埋点🌯</p></blockquote><p>优点：</p><blockquote><ul><li>由于采集的是全量数据，所以产品迭代过程中是不需要关注埋点逻辑的，也不会出现漏埋、误埋等现象。</li><li>无埋点方式因为收集的是全量数据，可以大大减少运营和产品的试错成本</li><li>如果集成sdk之后无需埋点，方便快捷</li></ul></blockquote><p>缺点：</p><blockquote><ul><li>缺点与可视化埋点相同，未解决个性化自定义获取数据的问题，缺乏数据获取的灵活性；</li><li>数据量过大，如果不使用第三方服务商，针对自身的服务器是个考验</li></ul></blockquote><h2 id="实现方案步骤（uni-app，其他项目逻辑相同）"><a href="#实现方案步骤（uni-app，其他项目逻辑相同）" class="headerlink" title="实现方案步骤（uni-app，其他项目逻辑相同）"></a>实现方案步骤（uni-app，其他项目逻辑相同）</h2><h4 id="两方面上报-1-事件上报-目前只有点击事件埋点-，2-停留时间上报"><a href="#两方面上报-1-事件上报-目前只有点击事件埋点-，2-停留时间上报" class="headerlink" title="两方面上报: 1.事件上报(目前只有点击事件埋点)，2.停留时间上报"></a>两方面上报: 1.事件上报(目前只有点击事件埋点)，2.停留时间上报</h4><ul><li><strong>事件上报</strong>：通过给元素绑定自定义指令的方式实现(减少对原有代码的侵入)🍜，将信息存储在缓存池中定时上报，上报之后清空之前的上报信息🥠。</li><li><strong>停留时间上报</strong>：需要重新封装路由，创建路由拦截在跳转之前记录来源,以及上一个页面的停留时间，当拦截器捕获成功之后🌯，如果发现停留时间大于xx秒进行上报🥙。</li></ul><p><em>优点</em>：清晰合理，比较适合新项目。</p><p><em>缺点</em>：针对老项目需要与产品和运营对接埋点方案绑定自定义事件🤪，如果是老项目需要对<code>uni.navigateTo</code>,<code>uni.redirectTo</code>,<code>uni.reLaunch</code>,<code>uni.switchTab</code> 进行二次封装。</p><blockquote><p>问：为什么何将信息存储，而不是实时上报？<br><br>答：考虑到服务器的压力，采用了定时上报的方式。<br><br><br>问：为什么监听停留时长大于XX秒才进行上报？<br><br>答：1.服务器的压力问题。2考虑到用户可能做一些没意义的操作，所以停留时长大于XX秒才属于有效页面。</p></blockquote><h2 id="实现方法"><a href="#实现方法" class="headerlink" title="实现方法"></a>实现方法</h2><p><strong>事件埋点上报</strong></p><ul><li>在<code>common</code>文件夹下创建自定义指令文件，在<code>main.js</code>中引用该文件。<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vue&quot;</span>;<br><span class="hljs-comment">// 自定义埋点指令</span><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">directive</span>(<span class="hljs-string">&quot;buried&quot;</span>, &#123;<br>  <span class="hljs-attr">bind</span>: <span class="hljs-function">(<span class="hljs-params">el, binding</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (binding.<span class="hljs-property">value</span>) &#123;<br>      <span class="hljs-comment">//这里参数是根据自己业务可以自己定义</span><br>      <span class="hljs-keyword">let</span> params = &#123;<br>        <span class="hljs-attr">currentUrl</span>: binding.<span class="hljs-property">value</span>.<span class="hljs-property">currentUrl</span>,<br>        <span class="hljs-attr">triggerType</span>: binding.<span class="hljs-property">value</span>.<span class="hljs-property">triggerType</span>,<br>        <span class="hljs-attr">title</span>: binding.<span class="hljs-property">value</span>.<span class="hljs-property">title</span>,<br>        <span class="hljs-attr">frontTriggerType</span>: binding.<span class="hljs-property">value</span>.<span class="hljs-property">triggerType</span>,<br>        <span class="hljs-attr">behavior</span>: binding.<span class="hljs-property">value</span>.<span class="hljs-property">behavior</span>,<br>      &#125;;<br>      <span class="hljs-comment">//如果是浏览类型，直接保存,目前只考虑点击类型</span><br>      <span class="hljs-keyword">if</span> (binding.<span class="hljs-property">value</span>.<span class="hljs-property">triggerType</span> == <span class="hljs-string">&quot;browse&quot;</span>) &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;browse&quot;</span>, params);<br>        <span class="hljs-comment">//调用后台接口保存数据</span><br>      &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (binding.<span class="hljs-property">value</span>.<span class="hljs-property">triggerType</span> == <span class="hljs-string">&quot;click&quot;</span>) &#123;<br>        <span class="hljs-comment">//如果是click类型，监听click事件</span><br>        el.<span class="hljs-title function_">addEventListener</span>(<br>          <span class="hljs-string">&quot;click&quot;</span>,<br>          <span class="hljs-function">() =&gt;</span> &#123;<br>            <span class="hljs-comment">// 将操作和内容存储在缓存中定时上报</span><br>            <span class="hljs-keyword">let</span> buriedArray = uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">&#x27;buriedArray&#x27;</span>) <span class="hljs-comment">//获取埋点集合</span><br>            buriedArray.<span class="hljs-title function_">push</span>(params)  <span class="hljs-comment">// 将埋点集合存入缓存中</span><br>            uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">&#x27;buriedArray&#x27;</span>, buriedArray)<br>          &#125;,<br>          <span class="hljs-literal">false</span><br>        );<br>      &#125;<br>    &#125;<br>  &#125;,<br>&#125;);<br></code></pre></div></td></tr></table></figure>在<code>app.vue</code>中的<code>onLaunch</code>生命周期中创建定时任务与缓存池,在<code>onHide</code>生命周期中销毁定时任务<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> timeInterval = <span class="hljs-literal">null</span><br><span class="hljs-title function_">onLaunch</span>(<span class="hljs-params"></span>)&#123;<br>  uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">&#x27;buriedArray&#x27;</span>, [])<br>		<span class="hljs-comment">// 定时上报埋点数据</span><br>		timeInterval = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>			<span class="hljs-keyword">if</span> (uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">&#x27;buriedArray&#x27;</span>).<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span>) &#123;<br>				<span class="hljs-comment">// 上报逻辑，根据需求自行完善</span><br>				<span class="hljs-title function_">upLoadBuriedInfo</span>(uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">&#x27;buriedArray&#x27;</span>))<br>				<span class="hljs-comment">// 上报成功之后清空埋点数据重新上报</span><br>				uni.<span class="hljs-title function_">setStorageSync</span>(<span class="hljs-string">&#x27;buriedArray&#x27;</span>, [])<br>			&#125;<br>		&#125;, time)<br>&#125;<br><span class="hljs-attr">onHide</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>		timeInterval &amp;&amp; <span class="hljs-built_in">clearInterval</span>(timeInterval)<br>&#125;<br></code></pre></div></td></tr></table></figure></li></ul><p><strong>停留时间上报</strong></p><ul><li>首先读取<code>page.json</code>中的文件获取<code>path</code>和<code>title</code>(<a target="_blank" rel="noopener" href="https://www.yezipi.net/article/detail/10086">原文链接</a>)，先在项目根目录创建一个<code>router</code>文件夹🍞，在<code>vue.config.js</code>里面加入如下代码,这样每次打包之后<code>router</code>文件夹下的<code>index.js</code>中就会生成一个 <code>title</code>和<code>path</code>的对应表。😚<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>)<br><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>)<br><br><span class="hljs-keyword">const</span> fromFile = path.<span class="hljs-title function_">join</span>(__filename, <span class="hljs-string">&#x27;../pages.json&#x27;</span>)<br><span class="hljs-keyword">const</span> toFile = path.<span class="hljs-title function_">join</span>(__filename, <span class="hljs-string">&#x27;../router/index.js&#x27;</span>)<br><span class="hljs-keyword">const</span> buffPrefix = <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">from</span>(<span class="hljs-string">&#x27;export default &#x27;</span>)<br><br><span class="hljs-keyword">const</span> fileData = fs.<span class="hljs-title function_">readFileSync</span>(fromFile)<br><br><span class="hljs-comment">// 转成可读的js, 正则删除注释， 不然JSON.parse会报错</span><br><span class="hljs-keyword">const</span> fileObj = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(fileData.<span class="hljs-title function_">toString</span>().<span class="hljs-title function_">replace</span>(<span class="hljs-regexp">/\/\/.*/g</span>, <span class="hljs-string">&#x27;&#x27;</span>))<br><br><span class="hljs-comment">// 遍历，只取路径和标题，其他的不要，已减小文件体积</span><br><span class="hljs-keyword">const</span> routes = fileObj.<span class="hljs-property">pages</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123;<br>	<span class="hljs-keyword">return</span> &#123;<br>		<span class="hljs-attr">title</span>: e.<span class="hljs-property">style</span> ? e.<span class="hljs-property">style</span>.<span class="hljs-property">navigationBarTitleText</span> ? e.<span class="hljs-property">style</span>.<span class="hljs-property">navigationBarTitleText</span> : e.<span class="hljs-property">name</span> : <span class="hljs-string">&#x27;未知&#x27;</span>,<br>		<span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/&#x27;</span>+e.<span class="hljs-property">path</span>,<br>	&#125;<br>&#125;)<br>fs.<span class="hljs-title function_">writeFileSync</span>(toFile, buffPrefix + <span class="hljs-title class_">Buffer</span>.<span class="hljs-title function_">from</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(routes)))<br><br><span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = &#123;<br>	<span class="hljs-attr">configureWebpack</span>: &#123;<br>		<span class="hljs-attr">plugins</span>: []<br>	&#125;<br>&#125;<br></code></pre></div></td></tr></table></figure></li><li>在common中创建routeGuards.js 监听路由拦截，进行上报，在main.js中引用该文件<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Vue</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">import</span> v5 <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;uuid/v5&#x27;</span>;<br><span class="hljs-keyword">import</span> <span class="hljs-title class_">UniRouteGuard</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/js_sdk/pocky-route-gurads/lib&#x27;</span>;<br><span class="hljs-keyword">import</span> router <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/router&#x27;</span><br><span class="hljs-title class_">Vue</span>.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">UniRouteGuard</span>);<br><br><span class="hljs-keyword">const</span> guard = <span class="hljs-keyword">new</span> <span class="hljs-title class_">UniRouteGuard</span>();<br><br><span class="hljs-keyword">let</span> startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<br>guard.<span class="hljs-title function_">beforeEach</span>(<span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span>, next</span>) =&gt;</span> &#123;<br>	<span class="hljs-keyword">let</span> currentTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<br>	<span class="hljs-keyword">if</span> (<span class="hljs-keyword">from</span>.<span class="hljs-property">url</span> &amp;&amp; <span class="hljs-keyword">from</span>.<span class="hljs-property">url</span> == <span class="hljs-string">&#x27;/pages/first/index&#x27;</span>) &#123;<br>		<span class="hljs-title function_">next</span>()<br>		<span class="hljs-keyword">return</span><br>	&#125;<br>	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(router)<br>	<span class="hljs-keyword">if</span> (to.<span class="hljs-property">url</span>) &#123;<br>		<span class="hljs-keyword">if</span> (to.<span class="hljs-property">url</span>.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;?&#x27;</span>) &gt; -<span class="hljs-number">1</span>) &#123;<br>			to.<span class="hljs-property">url</span> = to.<span class="hljs-property">url</span>.<span class="hljs-title function_">substr</span>(<span class="hljs-number">0</span>, to.<span class="hljs-property">url</span>.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;?&#x27;</span>))<br>		&#125;<br>	&#125;<br>	<span class="hljs-keyword">let</span> fromName = router.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">path</span> == <span class="hljs-keyword">from</span>.<span class="hljs-property">url</span>) ? router.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">path</span> == <span class="hljs-keyword">from</span>.<span class="hljs-property">url</span>).<span class="hljs-property">title</span> : <span class="hljs-string">&#x27;未知&#x27;</span><br>	<span class="hljs-keyword">let</span> toName = router.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">path</span> == to.<span class="hljs-property">url</span>) ? router.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">path</span> == to.<span class="hljs-property">url</span>).<span class="hljs-property">title</span> : <span class="hljs-string">&#x27;未知&#x27;</span><br>  <span class="hljs-keyword">const</span> stayTime=  <span class="hljs-built_in">parseInt</span>((currentTime - startTime) / <span class="hljs-number">1000</span>)<br>	<span class="hljs-keyword">const</span> <span class="hljs-variable constant_">MY_NAMESPACE</span> = <span class="hljs-string">&#x27;1b671a64-40d5-491e-99b0-da01ff1f3341&#x27;</span>;<br><br>	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">`由<span class="hljs-subst">$&#123;fromName&#125;</span>跳转到<span class="hljs-subst">$&#123;toName&#125;</span>并在<span class="hljs-subst">$&#123;fromName&#125;</span>中停留了<span class="hljs-subst">$&#123;stayTime&#125;</span>秒钟`</span>);<br>	<span class="hljs-keyword">let</span> params = &#123;<br>		<span class="hljs-attr">fromUrl</span>: <span class="hljs-keyword">from</span>.<span class="hljs-property">url</span>, <span class="hljs-comment">//来源地址</span><br>		<span class="hljs-attr">toUrl</span>: to.<span class="hljs-property">url</span>, <span class="hljs-comment">// 目的地址</span><br>		<span class="hljs-attr">fromName</span>: fromName, <span class="hljs-comment">// 来源名称</span><br>		<span class="hljs-attr">toName</span>: toName, <span class="hljs-comment">// 目的名称</span><br>		<span class="hljs-attr">stayTime</span>: stayTime, <span class="hljs-comment">// 停留时长</span><br>		<span class="hljs-attr">guid</span>: <span class="hljs-title function_">v5</span>(<span class="hljs-keyword">from</span>.<span class="hljs-property">url</span>, <span class="hljs-variable constant_">MY_NAMESPACE</span>), <span class="hljs-comment">//页面uuid</span><br>		<span class="hljs-attr">appUuid</span>: uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">&#x27;appUuid&#x27;</span>) ? uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">&#x27;appUuid&#x27;</span>) : <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// app唯一标识</span><br>		<span class="hljs-attr">model</span>: uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">&quot;model&quot;</span>)? uni.<span class="hljs-title function_">getStorageSync</span>(<span class="hljs-string">&#x27;model&#x27;</span>) : <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-comment">// 手机型号</span><br>	&#125;<br>	<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(params)<br>  <span class="hljs-keyword">if</span>(stayTime&gt;<span class="hljs-number">10</span>)&#123;<br>   <span class="hljs-comment">// 上报逻辑</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;停留的时间大于10秒钟了，可以进行上报&#x27;</span>)<br>  &#125;<br>  startTime = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();<br>	<span class="hljs-title function_">next</span>();<br>&#125;);<br></code></pre></div></td></tr></table></figure><blockquote><p>因为<code>uni-app</code>没有提供自身的路由拦截插件🥠，所以需要我们手动去封装🚘。这种方案针对新项目比较合适，但是针对老项目路由跳转的逻辑都已经通过原生的方式写完了😣，我们在进行封装的话修改的点太多了🤔，所以在网上找到了这个插件不用修改跳转<code>api</code>并且可以获取到上一个页面的路由(<a target="_blank" rel="noopener" href="https://ext.dcloud.net.cn/plugin?id=1955">全局路由守卫</a>)，原文介绍的是通过<code>npm</code>的方式进行安装，我采用的是<code>hbuilderX</code>导入的方式（有需要的同学可以自行查找）🤙。</p></blockquote><h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><blockquote><ul><li>事件埋点:将需要埋点的元素绑定改指令<code>v-buried</code>绑定参数</li></ul></blockquote><figure class="highlight html"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- </span><br><span class="hljs-comment">triggerType: 事件类型</span><br><span class="hljs-comment">title: 页面标题</span><br><span class="hljs-comment">currentUrl: 页面路由</span><br><span class="hljs-comment">behavior: 操作行为</span><br><span class="hljs-comment">--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">view</span> <span class="hljs-attr">v-buried</span>=<span class="hljs-string">&quot;&#123;</span></span><br><span class="hljs-string"><span class="hljs-tag">triggerType:&#x27;click&#x27;,</span></span><br><span class="hljs-string"><span class="hljs-tag">title:&#x27;我的&#x27;,</span></span><br><span class="hljs-string"><span class="hljs-tag">currentUrl: currentPath,</span></span><br><span class="hljs-string"><span class="hljs-tag">behavior:&#x27;点击我的收藏按钮&#x27;&#125;&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">view</span>&gt;</span><br></code></pre></div></td></tr></table></figure><blockquote><p>页面跳转</p><ul><li><strong><span style="color:red">需要在<code>page.json</code>中进行修改如果使用的是自定义导航条或者没有使用导航条需要进行命名</span></strong></li><li><strong><span style="color:red">需要将页面中跳转路径修改成绝对路径否则路由会匹配不到</span></strong></li></ul></blockquote></li></ul><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/eee650f8901e46b4bf2d91959d12dfd8~tplv-k3u1fbpfcp-zoom-1.image" srcset="/img/loading.gif" lazyload></p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ce20f15c81f04a8c829570903785c07c~tplv-k3u1fbpfcp-zoom-1.image" srcset="/img/loading.gif" lazyload></p><h2 id="uni-app集成友盟统计"><a href="#uni-app集成友盟统计" class="headerlink" title="uni-app集成友盟统计"></a>uni-app集成友盟统计</h2><ul><li>首先在<a target="_blank" rel="noopener" href="https://www.umeng.com/">友盟</a>上创建一个应用获取其对应的appkey</li></ul><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8a6c0312a506479aa2b5701cb02fd7f2~tplv-k3u1fbpfcp-zoom-1.image" srcset="/img/loading.gif" lazyload></p><ul><li>在uni-app的App模块配置中勾选友盟统计并填写对应的key（渠道id随意填写就可以）<br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d8ba932112484748bbe51bc08d8d8d01~tplv-k3u1fbpfcp-zoom-1.image" srcset="/img/loading.gif" lazyload></li><li>这样实际上就在uni-app中集成了友盟统计，如果想看到详细的上报数据可以在友盟后台进行查看（注：<strong>必须打包之后或者采用自定义基座的方式才能够进行上报，上报结果可能第二天才会生效，具体上报规则可以查看友盟官网解释</strong>）。</li></ul><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c1596886f6664d259ba6f1a258ecdf11~tplv-k3u1fbpfcp-zoom-1.image" srcset="/img/loading.gif" lazyload><br>这样最基本的集成就完成了。</p><blockquote><p>那我们如何埋入我们的自定义事件呢，比如我将一个燃气罩加入了购物车把他当成一个事件，并且能在友盟后台查看到我加入商品的属性以及加入空气炸锅或者加入电饼铛的一些数量对比</p></blockquote><ul><li>1.在友盟后台注册相应的自定义事件 （我的应用-&gt;设置-&gt;添加事件）<br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/89326fce60d740bf8fd499283e4c7174~tplv-k3u1fbpfcp-zoom-1.image" srcset="/img/loading.gif" lazyload></li><li>2.创建事件完毕之后在代码中进行上报的代码的编写（步骤一和步骤二谁先谁后都可以）<figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// https://www.html5plus.org/doc/zh_cn/statistic.html 文档链接</span><br><span class="hljs-comment">// 第一个参数: 在友盟后台注册的事件id，第二个参数：业务数据</span><br>plus.<span class="hljs-property">statistic</span>.<span class="hljs-title function_">eventTrig</span>(<span class="hljs-string">&quot;purchase&quot;</span>, &#123;<span class="hljs-string">&quot;type&quot;</span>:<span class="hljs-string">&quot;book&quot;</span>,<span class="hljs-string">&quot;quantity&quot;</span>:<span class="hljs-string">&quot;3&quot;</span>&#125;);<br></code></pre></div></td></tr></table></figure></li><li>上报可能会有延迟，发行过一段时间之后就可以在友盟后台查看到相关数据。</li></ul><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8a33f98011694e14ac9b128a14a1ebdf~tplv-k3u1fbpfcp-zoom-1.image" srcset="/img/loading.gif" lazyload></p><ul><li>点击查看按钮可以看到更详细的数据，以及上报的业务数据对比</li></ul><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e0c6efaab72a4e84830787f6c01cbff8~tplv-k3u1fbpfcp-zoom-1.image" srcset="/img/loading.gif" lazyload></p><h2 id="uni-app-自带统计"><a href="#uni-app-自带统计" class="headerlink" title="uni-app 自带统计"></a>uni-app 自带统计</h2><ul><li>无需集成其他相关sdk只需在manifest.json中勾选uni统计配置即可注：<strong>必须打包之后才能够进行上报，上报结果可能第二天才会生效，具体上报规则可以查看uni-app官网解释</strong>）<br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/128eb5aed151400caa8cb74c744e4dae~tplv-k3u1fbpfcp-zoom-1.image" srcset="/img/loading.gif" lazyload></li><li><a target="_blank" rel="noopener" href="https://tongji.dcloud.net.cn/">查看上报后台</a></li></ul><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/16aaaab3b182478c94daf0b8747f7f04~tplv-k3u1fbpfcp-zoom-1.image" srcset="/img/loading.gif" lazyload></p><ul><li>uni统计也支持<a target="_blank" rel="noopener" href="https://ask.dcloud.net.cn/article/36304">自定义埋点事件</a>的上报</li></ul><figure class="highlight javascript"><table><tr><td class="gutter hljs"><div class="hljs code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><div class="hljs code-wrapper"><pre><code class="hljs javascript"><span class="hljs-comment">// 注意如果第一个参数是title第二个参数必须是字符串</span><br>uni.<span class="hljs-title function_">report</span>(<span class="hljs-string">&quot;upload&quot;</span>,&#123;<br>					<span class="hljs-attr">title</span>: <span class="hljs-string">&#x27;上报数据&#x27;</span>,<br>					<span class="hljs-attr">content</span>: <span class="hljs-string">&#x27;上报内容&#x27;</span><br>				&#125;)<br></code></pre></div></td></tr></table></figure><ul><li>可在事件和转化模块中进行查看</li></ul><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a8e44fa5d16c40bcac87b7fcce0101bb~tplv-k3u1fbpfcp-zoom-1.image" srcset="/img/loading.gif" lazyload></p><p>在测试uni-app自带的统计中也遇到了一些问题，如果有朋友能够解决的话也可以帮助顶顶帖，我在进行完善<a target="_blank" rel="noopener" href="https://ask.dcloud.net.cn/question/143724">问题贴</a>。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>针对埋点的方案，自己也是不太熟悉，没有实战经验，找了很多途径，文中可能会有不对的地方，希望小伙伴们可以多多指点。一起加油！🤪<br><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c81e2a9622b5431e82e1bf427e27f0d5~tplv-k3u1fbpfcp-zoom-1.image" srcset="/img/loading.gif" lazyload></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ul><li><p><a target="_blank" rel="noopener" href="https://www.yezipi.net/article/detail/10086">获取Page.json</a></p></li><li><p><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/20448467">如何清楚易懂的解释“UV和PV＂的定义？</a></p></li><li><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/37cbb7607ca4">埋点区别</a></p></li></ul></div><hr><div><div class="post-metas mb-3"><div class="post-meta mr-3"><i class="iconfont icon-category"></i> <a class="hover-with-bg" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a class="hover-with-bg" href="/tags/Vue/">Vue</a> <a class="hover-with-bg" href="/tags/uni-app/">uni-app</a></div></div><p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！谢谢</p><div class="post-prevnext"><article class="post-prev col-6"><a href="/2022/05/17/%E6%88%91%E6%B1%82%E6%B1%82%E4%BD%A0%E5%86%99%E4%B8%AA%E5%8D%9A%E5%AE%A2%E5%90%A7/"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">🎈我求求你写个博客吧🎈</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/2022/05/17/electron%E8%B0%83%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9dll/"><span class="hidden-mobile">electron调用第三方dll</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article class="comments" id="comments" lazyload><script type="text/javascript">Fluid.utils.loadComments("#comments",(function(){var t=document.documentElement.getAttribute("data-user-color-scheme");t="dark"===t?"github-dark":"github-light",window.UtterancesThemeLight="github-light",window.UtterancesThemeDark="github-dark";var e=document.createElement("script");e.setAttribute("src","https://utteranc.es/client.js"),e.setAttribute("repo","drinkwd/drinkwd.github.io"),e.setAttribute("issue-term","title"),e.setAttribute("label","utterances"),e.setAttribute("theme",t),e.setAttribute("crossorigin","anonymous"),document.getElementById("comments").appendChild(e)}))</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer class="text-center mt-5 py-3"><div class="footer-content"><a href="https://github.com/drinkwd" target="_blank" rel="nofollow noopener"><span>gitHub</span></a> <i class="iconfont icon-love"></i> <a href="https://juejin.cn/user/3632442148403879" target="_blank" rel="nofollow noopener"><span>掘金</span></a></div><div class="statistics"><span id="busuanzi_container_site_pv" style="display:none">总访问量 <span id="busuanzi_value_site_pv"></span> 次 </span><span id="busuanzi_container_site_uv" style="display:none">总访客数 <span id="busuanzi_value_site_uv"></span> 人</span></div></footer><script src="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://cdn.staticfile.org/jquery/3.5.1/jquery.min.js"></script><script src="https://cdn.staticfile.org/bootstrap/4.5.3/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="/js/local-search.js"></script><script src="/js/img-lazyload.js"></script><script src="https://cdn.staticfile.org/tocbot/4.12.0/tocbot.min.js"></script><script src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/anchor-js/4.3.0/anchor.min.js"></script><script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js"></script><script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.staticfile.org/typed.js/2.0.12/typed.min.js"></script><script>!function(t,i){(0,Fluid.plugins.typing)(i.getElementById("subtitle").title)}(window,document)</script><script src="/live2d-widget/autoload.js"></script><script src="/js/boot.js"></script><div id="aplayer" style="right:0"></div><link defer rel="stylesheet" href="https://cdn.staticfile.org/aplayer/1.10.1/APlayer.min.css"><script src="https://cdn.staticfile.org/aplayer/1.10.1/APlayer.min.js"></script><script defer src="/js/music.js"></script></body></html>