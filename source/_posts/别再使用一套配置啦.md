---
title: åˆ«å†ä½¿ç”¨ä¸€å¥—é…ç½®å•¦ğŸ¤”
tags: [Vue,ä»£ç äººç”Ÿ]
categories: æŠ€æœ¯
index_img: /img/blog_img/index16.png
banner_img: /img/blog_img/banner16.jpg
---
## å‰è¨€
ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œç”Ÿæˆç¯å¢ƒï¼Œæœ‰å¾ˆå¤šå¼€å‘åŒ…æ‹¬æˆ‘åœ¨å†…ä¹Ÿåªé‡‡ç”¨ä¸€å¥—çš„é…ç½®ğŸ˜¢ï¼Œå…¬ç”¨ä¸€å¥—é…ç½®æ–‡ä»¶ä¼šæœ‰å¾ˆå¤šå¼Šç«¯ï¼ŒåŒ…æ‹¬æ€§èƒ½éšæ‚£ã€ä¸åœçš„ä¿®æ”¹é…ç½®ã€ç­‰ç­‰ğŸ¤¢ã€‚
- é…ç½®æ–‡ä»¶æ¯”è¾ƒå†—ä½™ï¼Œæœ‰å¾ˆå¤šé…ç½®æˆ‘ä»¬åœ¨ä¸åŒç¯å¢ƒå¯¹åº”çš„é…ç½®æ˜¯ä¸ç›¸åŒçš„ğŸ‘€ã€‚
- æ¯æ¬¡æäº¤æµ‹è¯•çš„çš„æ—¶å€™æ¯æ¬¡éƒ½éœ€è¦ä¿®æ”¹ä¸€ä¸‹åå°çš„é“¾æ¥åœ°å€ğŸ¤”ã€‚
## å¼€å‘ç¯å¢ƒä¸ç”Ÿäº§ç¯å¢ƒåŒºåˆ«

> å¼€å‘ç¯å¢ƒé…ç½®
> - æ¨¡å—çƒ­æ›´æ–°ï¼ˆæœ¬åœ°å¼€å¯æœåŠ¡ï¼Œå®æ—¶æ›´æ–°ï¼‰
> - sourceMap (æ–¹ä¾¿è°ƒè¯•ï¼Œå®šä½é—®é¢˜)
> - æ¥å£ä»£ç†(é…ç½®proxyTableè§£å†³å¼€å‘ç¯å¢ƒä¸­çš„è·¨åŸŸé—®é¢˜)
> - ä»£ç è§„èŒƒæ£€æŸ¥ (ä»£ç è§„èŒƒæ£€æŸ¥å·¥å…·)

> ç”Ÿäº§ç¯å¢ƒé…ç½®
> - æå–å…¬å…±ä»£ç 
> - å‹ç¼©æ··æ·†(å‹ç¼©æ··æ·†ä»£ç ï¼Œæ¸…é™¤ä»£ç ç©ºæ ¼ï¼Œæ³¨é‡Šç­‰ä¿¡æ¯ä½¿å…¶å˜å¾—éš¾ä»¥é˜…è¯»)ã€€ã€€ã€€
> - æ–‡ä»¶å‹ç¼©/base64ç¼–ç (å‹ç¼©ä»£ç ï¼Œå‡å°‘çº¿ä¸Šç¯å¢ƒæ–‡ä»¶åŒ…çš„å¤§å°)ã€€ã€€ã€€
> - å»é™¤æ— ç”¨çš„ä»£ç ã€€ã€€ã€€ã€€

> å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„å…±åŒé…ç½®
> - åŒæ ·çš„å…¥å£
> - åŒæ ·çš„ä»£ç å¤„ç†(loaderå¤„ç†)
> - åŒæ ·çš„è§£æé…ç½®

ç»¼ä¸Šï¼šæˆ‘ä»¬æœ‰å¿…è¦æŠ½ç¦»å‡ºä¸¤ç§ç¯å¢ƒï¼Œæ¥é¿å…ä¸Šé¢æƒ…å†µçš„å‘ç”ŸğŸ¤ï¼Œç”±äºæˆ‘ä»¬çš„é¡¹ç›®ç”¨çš„æ˜¯`@vue/cli 5.0.4`æ‰€ä»¥æˆ‘ä¸‹é¢çš„å†…å®¹éƒ½æ˜¯é’ˆå¯¹`@vue/cli`ğŸ’‹

## æ¦‚å¿µï¼ˆå¼•ç”¨å®˜ç½‘ï¼‰
æ¨¡å¼æ˜¯ `Vue CLI`é¡¹ç›®ä¸­ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ª `Vue CLI `é¡¹ç›®æœ‰ä¸‰ä¸ªæ¨¡å¼ğŸ‘‡

- `development` æ¨¡å¼ç”¨äº `vue-cli-service serve`ğŸ¨
- `test` æ¨¡å¼ç”¨äº `vue-cli-service test:unit`ğŸ¨
- `production` æ¨¡å¼ç”¨äº` vue-cli-service build` å’Œ `vue-cli-service test:e2e`ğŸ¨

å½“è¿è¡Œ `vue-cli-service` å‘½ä»¤æ—¶ğŸ‘ï¼Œæ‰€æœ‰çš„ç¯å¢ƒå˜é‡éƒ½ä»å¯¹åº”çš„**ç¯å¢ƒæ–‡ä»¶**(ä¸‹æ–‡ä¼šæåˆ°)ä¸­è½½å…¥ã€‚å¦‚æœæ–‡ä»¶å†…éƒ¨ä¸åŒ…å« `NODE_ENV` å˜é‡ï¼Œå®ƒçš„å€¼å°†å–å†³äºæ¨¡å¼ğŸŠã€‚

> é€šä¿—çš„æ¥è¯´ï¼š`Vue CLI`å·²ç»é»˜è®¤å¸®åŠ©æˆ‘ä»¬åšäº†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„åŒºåˆ†ğŸ¤·â€â™€ï¸ï¼Œå½“æˆ‘ä»¬æ‰§è¡Œ`vue-cli-service serve`çš„æ—¶å€™å°±æ˜¯å¼€å‘ç¯å¢ƒğŸ“ã€‚æ‰§è¡Œ `vue-cli-servie build`çš„æ—¶å€™å°±ç”Ÿäº§ç¯å¢ƒâš½ã€‚å¹¶ä¸”`NODE_ENV`ä¼šè¢«æŒ‡å®šæˆå¯¹åº”çš„å€¼ï¼Œä¹Ÿå°±ä»£è¡¨æˆ‘ä»¬åœ¨å…¨å±€å¯ä»¥é€šè¿‡ä½¿ç”¨`process.env.NODE_ENV`æ¥åˆ¤æ–­æ˜¯ç”Ÿäº§ç¯å¢ƒè¿˜æ˜¯å¼€å‘ç¯å¢ƒğŸ‘ã€‚
## ç¯å¢ƒæ–‡ä»¶
ä½ å¯ä»¥åœ¨ä½ çš„é¡¹ç›®æ ¹ç›®å½•ä¸­æ”¾ç½®ä¸‹åˆ—æ–‡ä»¶æ¥æŒ‡å®šç¯å¢ƒå˜é‡ï¼Œå¦‚æœåœ¨è¿™äº›æ–‡ä»¶ä¸­æŒ‡å®šäº†`NODE_ENV`ä¼šè¦†ç›–ä¸Šæ–¹çš„`NODE_ENV`â¤ã€‚
```c#
# [mode]ï¼šdevelopment|test|production
.env                # åœ¨æ‰€æœ‰çš„ç¯å¢ƒä¸­è¢«è½½å…¥
.env.local          # åœ¨æ‰€æœ‰çš„ç¯å¢ƒä¸­è¢«è½½å…¥ï¼Œä½†ä¼šè¢« git å¿½ç•¥
.env.[mode]         # åªåœ¨æŒ‡å®šçš„æ¨¡å¼ä¸­è¢«è½½å…¥
.env.[mode].local   # åªåœ¨æŒ‡å®šçš„æ¨¡å¼ä¸­è¢«è½½å…¥ï¼Œä½†ä¼šè¢« git å¿½ç•¥
```
- ä¸€ä¸ªç¯å¢ƒæ–‡ä»¶åªåŒ…å«ç¯å¢ƒå˜é‡çš„â€œé”®=å€¼â€å¯¹ã€‚
```env
NODE_ENV=development
VUE_APP_NOT_SECRET_CODE=some_value
```
> **æ³¨æ„**ï¼šåªæœ‰ `NODE_ENV`ï¼Œ`BASE_URL` å’Œä»¥` VUE_APP_` å¼€å¤´çš„å˜é‡ğŸ¶å°†é€šè¿‡ `webpack.DefinePlugin` é™æ€åœ°åµŒå…¥åˆ°å®¢æˆ·ç«¯ä¾§çš„ä»£ç ä¸­ğŸ˜œ,å¯ä»¥åœ¨å®¢æˆ·ç«¯è¿›è¡Œä½¿ç”¨ã€‚è¿™æ˜¯ä¸ºäº†é¿å…æ„å¤–å…¬å¼€æœºå™¨ä¸Šå¯èƒ½å…·æœ‰ç›¸åŒåç§°çš„ç§é’¥âœ”ã€‚

- åŠ è½½ç¯å¢ƒæ–‡ä»¶çš„ä¼˜å…ˆçº§
```c#
# developmentï¼š
 npm run serve: .env.development.local, .env.local, .env.development,.env
# productionï¼š
 npm run build: .env.production.local, .env.local, .env.production,.env
```

## å¦‚ä½•æŸ¥çœ‹vue.config.jsä¸­ç”Ÿäº§ç¯å¢ƒå’Œå¼€å‘ç¯å¢ƒçš„é…ç½®
```c#
# å¼€å‘ç¯å¢ƒï¼š
npx vue-cli-service inspect --mode development >> webpack.config.development.js
# ç”Ÿäº§ç¯å¢ƒï¼š
npx vue-cli-service inspect --mode production >> webpack.config.production.js
# åœ¨äº§ç”Ÿçš„ js æ–‡ä»¶å¼€å¤´ï¼Œæ·»åŠ ï¼šmodule.exports =ç„¶åæ ¼å¼åŒ–å³å¯æŸ¥çœ‹ã€‚
```
## ç¯å¢ƒæ­å»º

- é€šè¿‡`vue-cli`æ­å»ºä¸€ä¸ªç©ºé¡¹ç›®
```cmd
vue create env_project
```
- åœ¨`app.vue`çš„`mounted`ç”Ÿå‘½å‘¨æœŸä¸­å¢åŠ å¦‚ä¸‹ä»£ç 
```javascript
    if (process.env.NODE_ENV == "development") {
      alert("å¼€å‘ç¯å¢ƒ");
    } else if (process.env.NODE_ENV == "production") {
      alert("ç”Ÿäº§ç¯å¢ƒ");
    }
```
- è¿è¡Œ `npm run serve`
![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6006316ad4fc439da7352cb444d07c66~tplv-k3u1fbpfcp-zoom-1.image)
- ç”Ÿæˆ`dist`æ‰“åŒ…æ–‡ä»¶ 
```cmd
npm run build
```

- ä¸‹è½½[nginx](http://nginx.org/en/download.html)

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f0309a6005b14046a9a7808fa351cad1~tplv-k3u1fbpfcp-zoom-1.image)

- ä¸‹è½½å®‰è£…å®Œæˆä¹‹åä¿®æ”¹`nginx`é…ç½®æ–‡ä»¶`conf->nginx.conf `æŒ‡å®šæ‰“åŒ…æ–‡ä»¶

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3ce0d91dbb254446a36bce8f3bde5fd5~tplv-k3u1fbpfcp-zoom-1.image)

- å¯åŠ¨`nginx`

æ‰¾åˆ°`nginx`çš„å®‰è£…ç›®å½•åŒå‡»`nginx.exe`
- è®¿é—®`127.0.0.1`

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d141ccd041344897b19821120f2add4a~tplv-k3u1fbpfcp-zoom-1.image)

> ç»¼ä¸Šï¼šæˆ‘ä»¬åº”è¯¥å·²ç»å°†ç”Ÿäº§ç¯å¢ƒå’Œå¼€å‘ç¯å¢ƒåŒºåˆ†å¼€äº†ï¼Œå¯ä»¥æ ¹æ®ä¸åŒç¯å¢ƒä¿®æ”¹ä¸åŒçš„é…ç½®äº†ğŸˆã€‚

## åˆ›å»ºç¯å¢ƒæ–‡ä»¶æŒ‡å®šä¸åŒé…ç½®
åœ¨ä¸`vue.config.js`çš„åŒçº§ç›®å½•åˆ›å»º`.env.development` ä¸ `.env.production`å¹¶åœ¨`.env.development`ä¸­å†™å…¥å¦‚ä¸‹å†…å®¹ğŸ‘‡
```
# å®é™…é¡¹ç›®åƒä¸‡ä¸è¦åœ¨developmentä¸­å®šä¹‰NODEç¯å¢ƒä¸ºproductionï¼Œæˆ‘ä»¬æ˜¯ä¸ºäº†éªŒè¯æ˜¯å¦å¯ä»¥è¦†ç›–é»˜è®¤çš„ç¯å¢ƒ
NODE_ENV = production
```
- é‡å¯é¡¹ç›®

![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7a10c95e3d5144439cc5711102ae1196~tplv-k3u1fbpfcp-zoom-1.image)

## æ€»ç»“
 ç»¼ä¸Šæˆ‘ä»¬æ—¢ç„¶æ¸…æ¥šäº†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒçš„åŒºåˆ†æ–‡ä¸­æåˆ°çš„é—®é¢˜ä¹Ÿå°±è¿åˆƒè€Œè§£å•¦ğŸ¨,ç”Ÿäº§ç¯å¢ƒå’Œå¼€å‘ç¯å¢ƒåœ¨æ¯ç§è¯­è¨€ä¸­éƒ½æ˜¯å¿…é¡»è¦çŸ¥é“çš„ï¼Œå¸Œæœ›ä½ çœ‹å®Œä¹‹åä¼šæœ‰å¸®åŠ©å“¦ğŸ¤£ï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯vue-cli2.0å¯ä»¥çœ‹[è¿™é‡Œ](https://www.jianshu.com/p/dbf8ed21f39c)âœŒã€‚
 ![](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/64d67dcaebdf434499eb06061b181678~tplv-k3u1fbpfcp-zoom-1.image)
 
## å‚è€ƒæ–‡çŒ®
- [vueCLI](https://cli.vuejs.org/zh/guide/mode-and-env.html#%E6%A8%A1%E5%BC%8F%E5%92%8C%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F)

- [vuecli2.xçš„é…ç½®](https://www.jianshu.com/p/dbf8ed21f39c)

 

